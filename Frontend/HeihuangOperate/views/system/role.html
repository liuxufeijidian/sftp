<link rel="stylesheet" type="text/css" href="/components/parsley/parsley.css" />
<style>
    .form-group {
        margin-left: 0px !important;
        margin-right: 0px !important;
    }
    .dd3-handle.current {
        background: #FDDFB3 !important;
        border: 1px solid #FAA937;
        color: #C27616 !important
    }
    .dd3-handle.current:before {
        color: #C27616 !important
    }
    .widget-footer {
        width: 100%;
        position: absolute;
        bottom: 0;
        margin-top: 20px;
    }
    .dd3-content.current {
        background: #FDDFB3 !important;
        border: 1px solid #FAA937;
        color: #C27616 !important
    }
</style>
<!-- widget grid -->
<section id="widget-grid" class="">
	<!-- row -->
	<div class="row">
		<!-- NEW WIDGET START -->
		<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<table id="jqgrid"></table>
			<div id="pjqgrid"></div>
		</article>
		<!-- WIDGET END -->
	</div>
	<!-- end row -->
</section>

<div id="addRoleWindow" class="fuelux">
	<div class="wizard">
		<div class="steps-container">
			<ul class="steps">
				<li data-step="1" class="active">
					<span class="badge badge-info">1</span>角色基础信息<span class="chevron"></span>
				</li>
				<li data-step="2">
					<span class="badge">2</span>分配权限<span class="chevron"></span>
				</li>
			</ul>
		</div>
		<div class="actions" style="background:none; border: none">
			<button type="button" class="btn btn-sm btn-primary btn-prev">
				<i class="fa fa-arrow-left"></i>上一步
			</button>
			<button type="button" class="btn btn-sm btn-success btn-next" data-last="完成">
				下一步<i class="fa fa-arrow-right"></i>
			</button>
		</div>
		<div class="step-content" style="margin-top: 80px">
			<form class="form-horizontal" id="addRoleForm" data-parsley-validate data-parsley-ui-enabled="false">
				<div class="step-pane active" id="step1" data-step="1" ng-app="addRoleStep">
					<h3 style="padding-left: 20px"><strong>第一步</strong> - 角色基础信息</h3>
					<fieldset id="addRoleField">
						<div class="form-group">
							<label class="col-xs-4 col-sm-4 col-md-4 col-lg-4 control-label">角色名</label>
							<div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
								<div class="input-group">
									<input class="form-control" type="text" name="roleName" required="">
								</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-4 col-sm-4 col-md-4 col-lg-4 control-label">角色描述</label>
							<div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
								<div class="input-group">
									<input class="form-control" type="text" name="roleDesc" required="">
								</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-4 col-sm-4 col-md-4 col-lg-4 control-label">角色编码</label>
							<div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
								<div class="input-group">
									<input class="form-control" type="text" name="roleCode" required="">
								</div>
							</div>
						</div>
					</fieldset>
				</div>
				<div class="step-pane" id="step2" data-step="2">
					<h3 style="padding-left: 20px"><strong>第二步</strong> - 分配权限</h3>
					<div class="row" style="padding: 0 15px;">
						<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6" ng-app="menuWidget">
							<div class="jarviswidget jarviswidget-color-purple jarviswidget-sortable" id="wid-id-10" data-widget-colorbutton="false" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false" role="widget">
								<header role="heading">
									<h2><strong>菜单维护</strong></h2>
									<div class="widget-toolbar" role="menu"></div>
								</header>

								<!-- widget div-->
								<div id="menuWidget" class="widget-div" role="content">
									<div class="jarviswidget-editbox"></div>
									<div class="widget-body no-padding" style="margin-top: 20px;" ng-controller="menuList" >
										<div class="dd" id="nestable3" style="margin-left: 8%;width:85%">
											<ol class="dd-list" ng-if="isNullArray == false">
												<li class="dd-item dd3-item" ng-repeat="(key, value) in menus">
													<div class="dd-handle dd3-handle">
														Drag
													</div>
													<div class="dd3-content">
														<input type="hidden" class="authId" value="{{value.smAuth.authId}}" />
														<input type="hidden" class="upperAuthId" value="{{value.smAuth.upperAuthId}}" />
														<input type="hidden" class="authUrl" value="{{value.smAuth.authUrl}}" />
														<input type="hidden" class="authCode" value="{{value.smAuth.authCode}}" />
														<input type="hidden" class="authDesc" value="{{value.smAuth.authDesc}}" />
														<input type="hidden" class="sort" value="{{value.smAuth.sort}}" />
														<input type="hidden" class="state" value="{{value.smAuth.state}}" />
														<span class="authName">{{value.smAuth.authName}}</span>
														<div class="pull-right" ng-if="value.smAuth.state == 1">
															已启用
														</div>
														<div class="pull-right" ng-if="value.smAuth.state == 0">
															<p style="color:red">
																禁用
															</p>
														</div>
													</div>
													<ol class="dd-list" ng-repeat="subMenu in value.subSmAuths">
														<li class="dd-item dd3-item">
															<div class="dd-handle dd3-handle">
																Drag
															</div>
															<div class="dd3-content">
																<input type="hidden" class="authId" value="{{subMenu.authId}}" />
																<input type="hidden" class="upperAuthId" value="{{subMenu.upperAuthId}}" />
																<input type="hidden" class="authUrl" value="{{subMenu.authUrl}}" />
																<input type="hidden" class="authCode" value="{{subMenu.authCode}}" />
																<input type="hidden" class="authDesc" value="{{subMenu.authDesc}}" />
																<input type="hidden" class="sort" value="{{subMenu.sort}}" />
																<input type="hidden" class="state" value="{{subMenu.state}}" />
																<span class="authName">{{subMenu.authName}}</span>
																<div class="pull-right" ng-if="subMenu.state == 1">
																	已启用
																</div>
																<div class="pull-right" ng-if="subMenu.state == 0">
																	<p style="color:red">
																		禁用
																	</p>
																</div>
															</div>
														</li>
													</ol>
												</li>
											</ol>
											<p ng-if="isNullArray" style="text-align: center;line-height: 180px">
												当前还没建立菜单！
											</p>
											<div style="height:40px"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"  ng-app="buttonWidget">
							<div class="jarviswidget jarviswidget-color-greenDark jarviswidget-sortable" id="wid-id-2" data-widget-editbutton="false" role="widget">
								<header role="heading">
									<span class="widget-icon"> <i class="fa fa-table"></i> </span>
									<h2>按钮维护</h2>

									<span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>
								</header>

								<!-- widget div-->
								<div role="content" id="buttonWidget">
									<div class="jarviswidget-editbox"></div>
									<div class="widget-body no-padding" ng-controller="buttonList" id="buttonWidgetBody">
										<div class="table-responsive">
											<table class="table table-hover">
												<thead>
													<tr>
														<th style="display: none">按钮ID</th>
														<th>按钮名称</th>
														<th>按钮编码</th>
														<th>按钮描述</th>
														<th>对应链接</th>
														<th>按钮排序</th>
														<th>是否启用</th>
													</tr>
												</thead>
												<tbody>
													<tr ng-repeat="button in buttons">
														<td class="authId" style="display: none">{{button.authId}}</td>
														<td class="authName">{{button.authName}}</td>
														<td class="authCode">{{button.authCode}}</td>
														<td class="authDesc">{{button.authDesc}}</td>
														<td class="authUrl">{{button.authUrl}}</td>
														<td class="sort">{{button.sort}}</td>
														<td class="state" ng-if="button.state == 1" state="{{button.state}}">启用</td>
														<td class="state" ng-if="button.state == 0" state="{{button.state}}">禁用</td>
													</tr>
												</tbody>
											</table>
											<input id="menuId" type="hidden" value="0" onchange="angular.element(this).scope().loadButton()" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

<div id="updateRoleWindow" ng-app="updateRoleForm">
	<fieldset>
		<form class="form-inline smart-form" id="updateRoleForm" data-parsley-validate>
			<fieldset class="mySet" style="padding: 5px 14px 5px !important;background: none">
				<section>
					<label class="label">角色名</label>
					<label class="input">
						<input type="text" name="roleName" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">角色描述</label>
					<label class="input">
						<input type="text" name="roleDesc" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">角色编码</label>
					<label class="input">
						<input type="text" name="roleCode" class="input-xs form-control" required="">
						<input type="hidden" name="status" value="1">
						<input type="hidden" name="roleId">
					</label>
				</section>
			</fieldset>
		</form>
	</fieldset>
</div>

<script type="text/javascript" src="/lib/mod_ajax.js"></script>
<section id="scriptTag"></section>
<!--SCRIPT_PLACEHOLDER-->
<script type="text/javascript">
	require.async("/modules/system/role");
</script><!--ignore-->