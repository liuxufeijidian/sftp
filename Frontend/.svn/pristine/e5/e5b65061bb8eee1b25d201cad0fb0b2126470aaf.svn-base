<style>
    .dd3-handle.current {
        background: #FDDFB3 !important;
        border: 1px solid #FAA937;
        color: #C27616 !important
    }
    .dd3-handle.current:before {
        color: #C27616 !important
    }
    .widget-footer {
        width: 100%;
        position: absolute;
        bottom: 0;
        margin-top: 20px;
    }
    .dd3-content.current {
        background: #FDDFB3 !important;
        border: 1px solid #FAA937;
        color: #C27616 !important
    }
</style>
<link rel="stylesheet" type="text/css" href="/components/parsley/parsley.css" />
<section>
	<div class="alert alert-block alert-info">
		<p>
			提示：点击左侧菜单项，即可在右侧按钮列表中查看对应菜单的按钮！菜单对应链接可通过点击『查看』按钮得到详细信息！
		</p>
	</div>
	<div class="row">
		<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6" ng-app="menuWidget">
			<div class="jarviswidget jarviswidget-color-purple jarviswidget-sortable" id="wid-id-10" data-widget-colorbutton="false" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false" role="widget">
				<header role="heading">
					<h2><strong>菜单维护</strong></h2>
					<div class="widget-toolbar" role="menu"></div>
				</header>

				<!-- widget div-->
				<div id="menuWidget" class="widget-div" role="content">
					<div class="jarviswidget-editbox"></div>
					<div class="widget-body no-padding" style="margin-top: 20px;" ng-controller="menuList" style="max-height: 550px;overflow-y: auto">
						<div class="dd" id="nestable3" style="margin-left: 8%;">
							<ol class="dd-list" ng-if="isNullArray == false">
								<li class="dd-item dd3-item" ng-repeat="(key, value) in menus">
									<div class="dd-handle dd3-handle">
										Drag
									</div>
									<div class="dd3-content">
										<input type="hidden" class="authId" value="{{value.smAuth.authId}}" />
										<input type="hidden" class="upperAuthId" value="{{value.smAuth.upperAuthId}}" />
										<input type="hidden" class="authUrl" value="{{value.smAuth.authUrl}}" />
										<input type="hidden" class="authCode" value="{{value.smAuth.authCode}}" />
										<input type="hidden" class="authDesc" value="{{value.smAuth.authDesc}}" />
										<input type="hidden" class="sort" value="{{value.smAuth.sort}}" />
										<input type="hidden" class="state" value="{{value.smAuth.state}}" />
										<span class="authName">{{value.smAuth.authName}}</span>
										<div class="pull-right" ng-if="value.smAuth.state == 1">
											已启用
										</div>
										<div class="pull-right" ng-if="value.smAuth.state == 0">
											<p style="color:red">禁用</p>
										</div>
									</div>
									<ol class="dd-list" ng-repeat="subMenu in value.subSmAuths">
										<li class="dd-item dd3-item">
											<div class="dd-handle dd3-handle">
												Drag
											</div>
											<div class="dd3-content">
												<input type="hidden" class="authId" value="{{subMenu.authId}}" />
												<input type="hidden" class="upperAuthId" value="{{subMenu.upperAuthId}}" />
												<input type="hidden" class="authUrl" value="{{subMenu.authUrl}}" />
												<input type="hidden" class="authCode" value="{{subMenu.authCode}}" />
												<input type="hidden" class="authDesc" value="{{subMenu.authDesc}}" />
												<input type="hidden" class="sort" value="{{subMenu.sort}}" />
												<input type="hidden" class="state" value="{{subMenu.state}}" />
												<span class="authName">{{subMenu.authName}}</span>
												<div class="pull-right" ng-if="subMenu.state == 1">
													已启用
												</div>
												<div class="pull-right" ng-if="subMenu.state == 0">
													<p style="color:red">禁用</p>
												</div>
											</div>
										</li>
									</ol>
								</li>
							</ol>
							<p ng-if="isNullArray" style="text-align: center;line-height: 180px">
								当前还没建立菜单！
							</p>
							<div style="height:40px"></div>
						</div>
						<div class="widget-footer">
							<button class="btn btn-sm btn-success" id="addMenu"  type="button">
								<i class="fa fa-plus-circle"></i> 新增
							</button>
							<button class="btn btn-sm btn-info" id="editMenu" type="button">
								<i class="fa fa-pencil"></i> 修改
							</button>
							<button class="btn btn-sm btn-primary" id="checkMenu" type="button">
								<i class="fa fa-search"></i> 查看
							</button>
							<button class="btn btn-sm btn-danger" id="disableMenu" type="button">
								<i class="fa fa-times"></i> 禁用
							</button>
							<button class="btn btn-sm btn-success" id="refreshMenu" type="button" ng-click="loadMenu()" style="display: none">
								<i class="fa fa-plus-circle"></i> 刷新
							</button>
						</div>

					</div>
					<!-- end widget content -->

				</div>
				<!-- end widget div -->

			</div>
		</div>
		<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"  ng-app="buttonWidget">
			<div class="jarviswidget jarviswidget-color-greenDark jarviswidget-sortable" id="wid-id-2" data-widget-editbutton="false" role="widget">
				<header role="heading">
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>按钮维护</h2>

					<span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>
				</header>

				<!-- widget div-->
				<div role="content" id="buttonWidget">
					<div class="jarviswidget-editbox"></div>
					<div class="widget-body no-padding" ng-controller="buttonList">
						<div class="table-responsive">
							<table class="table table-hover">
								<thead>
									<tr>
										<th style="display: none">按钮ID</th>
										<th>按钮名称</th>
										<th>按钮编码</th>
										<th>按钮描述</th>
										<th>对应链接</th>
										<th>按钮排序</th>
										<th>是否启用</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat="button in buttons">
										<td class="authId" style="display: none">{{button.authId}}</td>
										<td class="authName">{{button.authName}}</td>
										<td class="authCode">{{button.authCode}}</td>
										<td class="authDesc">{{button.authDesc}}</td>
										<td class="authUrl">{{button.authUrl}}</td>
										<td class="sort">{{button.sort}}</td>
										<td class="state" ng-if="button.state == 1" state="{{button.state}}">启用</td>
										<td class="state" ng-if="button.state == 0" state="{{button.state}}">禁用</td>
									</tr>
								</tbody>
							</table>
							<input id="menuId" type="hidden" value="0" onchange="angular.element(this).scope().loadButton()" />
						</div>
						<div class="widget-footer">
							<button class="btn btn-sm btn-success" type="button" id="addButton">
								<i class="fa fa-plus-circle"></i> 新增
							</button>
							<button class="btn btn-sm btn-info" type="button" id="editButton">
								<i class="fa fa-pencil"></i> 修改
							</button>
							<button class="btn btn-sm btn-danger" type="button">
								<i class="fa fa-times"></i> 禁用
							</button>
							<button class="btn btn-sm btn-success" id="refreshButton" type="button" ng-click="loadButton()" style="display: none">
								<i class="fa fa-plus-circle"></i> 刷新
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<div id="addMenuWindow">
	<fieldset>
		<form class="form-inline smart-form" id="addMenuForm" data-parsley-validate>
			<fieldset class="mySet" style="padding: 5px 14px 5px !important;background: none">
				<section>
					<label class="label">菜单名</label>
					<label class="input">
						<input type="text" name="authName" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">菜单编码</label>
					<label class="input">
						<input type="text" name="authCode" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">菜单描述</label>
					<label class="input">
						<input type="text" name="authDesc" class="input-xs form-control">
					</label>
				</section>
				<section>
					<label class="label">响应链接</label>
					<label class="input">
						<input type="text" name="authUrl" class="input-xs form-control">
						<input type="hidden" name="upperAuthId" class="input-xs form-control" value="0">
						<input type="hidden" name="authType" class="input-xs form-control" value="0">
					</label>
				</section>
				<section>
					<label class="label">菜单顺序</label>
					<label class="input">
						<input type="text" name="sort" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">是否启用</label>
					<div class="inline-group">
						<label class="radio">
							<input type="radio" name="state" value="1" checked="checked">
							<i></i>启用
						</label>
						<label class="radio">
							<input type="radio" name="state" value="0">
							<i></i>禁用
						</label>
					</div>
				</section>
			</fieldset>
		</form>
	</fieldset>
</div>

<div id="editMenuWindow">
	<fieldset>
		<form class="form-inline smart-form" id="editMenuForm" data-parsley-validate>
			<fieldset class="mySet" style="padding: 5px 14px 5px !important;background: none">
				<section>
					<label class="label">菜单名</label>
					<label class="input">
						<input type="text" name="authName" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">菜单编码</label>
					<label class="input">
						<input type="text" name="authCode" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">菜单描述</label>
					<label class="input">
						<input type="text" name="authDesc" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">响应链接</label>
					<label class="input">
						<input type="text" name="authUrl" class="input-xs form-control" required="">
						<input type="hidden" name="upperAuthId" class="input-xs form-control" value="0">
						<input type="hidden" name="authId" class="input-xs form-control">
						<input type="hidden" name="authType" class="input-xs form-control" value="0">
					</label>
				</section>
				<section>
					<label class="label">菜单顺序</label>
					<label class="input">
						<input type="text" name="sort" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">是否启用</label>
					<div class="inline-group">
						<label class="radio">
							<input type="radio" name="state" value="1" checked="checked">
							<i></i>启用
						</label>
						<label class="radio">
							<input type="radio" name="state" value="0">
							<i></i>禁用
						</label>
					</div>
				</section>
			</fieldset>
		</form>
	</fieldset>
</div>

<div id="addButtonWindow">
	<fieldset>
		<form class="form-inline smart-form" id="addButtonForm" data-parsley-validate>
			<fieldset class="mySet" style="padding: 5px 14px 5px !important;background: none">
				<section>
					<label class="label">按钮名</label>
					<label class="input">
						<input type="text" name="authName" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">按钮编码</label>
					<label class="input">
						<input type="text" name="authCode" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">按钮描述</label>
					<label class="input">
						<input type="text" name="authDesc" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">响应链接</label>
					<label class="input">
						<input type="text" name="authUrl" class="input-xs form-control" required="">
						<input type="hidden" name="upperAuthId" class="input-xs form-control" value="0">
						<input type="hidden" name="authType" class="input-xs form-control" value="1">
					</label>
				</section>
				<section>
					<label class="label">按钮顺序</label>
					<label class="input">
						<input type="text" name="sort" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">是否启用</label>
					<div class="inline-group">
						<label class="radio">
							<input type="radio" name="state" value="1" checked="checked">
							<i></i>启用
						</label>
						<label class="radio">
							<input type="radio" name="state" value="0">
							<i></i>禁用
						</label>
					</div>
				</section>
			</fieldset>
		</form>
	</fieldset>
</div>


<div id="editButtonWindow">
	<fieldset>
		<form class="form-inline smart-form" id="editButtonForm" data-parsley-validate>
			<fieldset class="mySet" style="padding: 5px 14px 5px !important;background: none">
				<section>
					<label class="label">按钮名</label>
					<label class="input">
						<input type="text" name="authName" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">按钮编码</label>
					<label class="input">
						<input type="text" name="authCode" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">按钮描述</label>
					<label class="input">
						<input type="text" name="authDesc" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">响应链接</label>
					<label class="input">
						<input type="text" name="authUrl" class="input-xs form-control" required="">
						<input type="hidden" name="authId" class="input-xs form-control" value="0">
						<input type="hidden" name="upperAuthId" class="input-xs form-control" value="0">
						<input type="hidden" name="authType" class="input-xs form-control" value="1">
					</label>
				</section>
				<section>
					<label class="label">按钮顺序</label>
					<label class="input">
						<input type="text" name="sort" class="input-xs form-control" required="">
					</label>
				</section>
				<section>
					<label class="label">是否启用</label>
					<div class="inline-group">
						<label class="radio">
							<input type="radio" name="state" value="1" checked="checked">
							<i></i>启用
						</label>
						<label class="radio">
							<input type="radio" name="state" value="0">
							<i></i>禁用
						</label>
					</div>
				</section>
			</fieldset>
		</form>
	</fieldset>
</div>

<script type="text/javascript" src="/lib/mod_ajax.js"></script>
<section id="scriptTag"></section>
<!--SCRIPT_PLACEHOLDER-->
<script type="text/javascript">require.async("/modules/system/menu");</script>